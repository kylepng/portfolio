<!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<title>Snake</title>
<style>
  * { margin: 0; padding: 0; }
  body { background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: 'Courier New', monospace; }
  canvas { border: 2px solid #333; }
  #overlay { position: absolute; color: #0f0; text-align: center; font-size: 18px; top: 50%; transform: translateY(-50%); width: 100%; }
  #overlay .title { font-size: 32px; margin-bottom: 10px; }
  #score { position: absolute; top: 8px; left: 12px; color: #0f0; font-size: 14px; }
</style>
</head><body>
<canvas id="c"></canvas>
<div id="score">Score: 0</div>
<div id="overlay"><div class="title">SNAKE</div>Arrow Keys or WASD to move<br><br>Press any key to start</div>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const overlay = document.getElementById('overlay');
const scoreEl = document.getElementById('score');

const GRID = 20;
let W, H, cols, rows;
let snake, dir, nextDir, food, score, speed, gameLoop, started, gameOver;

function resize() {
  W = Math.min(window.innerWidth, window.innerHeight - 40);
  W = Math.floor(W / GRID) * GRID;
  H = W;
  canvas.width = W; canvas.height = H;
  cols = W / GRID; rows = H / GRID;
}

function init() {
  resize();
  const mid = Math.floor(cols / 2);
  snake = [{x: mid, y: Math.floor(rows/2)}, {x: mid-1, y: Math.floor(rows/2)}, {x: mid-2, y: Math.floor(rows/2)}];
  dir = {x: 1, y: 0}; nextDir = {x: 1, y: 0};
  score = 0; speed = 120; gameOver = false;
  placeFood();
  scoreEl.textContent = 'Score: 0';
}

function placeFood() {
  do { food = {x: Math.floor(Math.random()*cols), y: Math.floor(Math.random()*rows)}; }
  while (snake.some(s => s.x === food.x && s.y === food.y));
}

function draw() {
  ctx.fillStyle = '#111'; ctx.fillRect(0, 0, W, H);
  // Grid lines
  ctx.strokeStyle = '#1a1a1a';
  for (let x = 0; x <= W; x += GRID) { ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H); ctx.stroke(); }
  for (let y = 0; y <= H; y += GRID) { ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(W,y); ctx.stroke(); }
  // Food
  ctx.fillStyle = '#f44';
  ctx.beginPath();
  ctx.arc(food.x * GRID + GRID/2, food.y * GRID + GRID/2, GRID/2 - 2, 0, Math.PI*2);
  ctx.fill();
  // Snake
  snake.forEach((s, i) => {
    const g = Math.max(100, 255 - i * 8);
    ctx.fillStyle = i === 0 ? '#0f0' : `rgb(0,${g},0)`;
    ctx.fillRect(s.x * GRID + 1, s.y * GRID + 1, GRID - 2, GRID - 2);
    if (i === 0) { // Eyes
      ctx.fillStyle = '#000';
      const ex = dir.x !== 0 ? 4 * dir.x : 0;
      const ey = dir.y !== 0 ? 4 * dir.y : 0;
      ctx.fillRect(s.x*GRID + GRID/2 - 3 + ex, s.y*GRID + GRID/2 - 3 + ey, 3, 3);
      ctx.fillRect(s.x*GRID + GRID/2 + 1 + ex, s.y*GRID + GRID/2 - 3 + ey, 3, 3);
    }
  });
}

function update() {
  dir = nextDir;
  const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
  // Wrap around
  if (head.x < 0) head.x = cols - 1;
  if (head.x >= cols) head.x = 0;
  if (head.y < 0) head.y = rows - 1;
  if (head.y >= rows) head.y = 0;
  // Self collision
  if (snake.some(s => s.x === head.x && s.y === head.y)) {
    gameOver = true;
    clearInterval(gameLoop);
    overlay.innerHTML = `<div class="title">GAME OVER</div>Score: ${score}<br><br>Press any key to restart`;
    overlay.style.display = 'block';
    return;
  }
  snake.unshift(head);
  if (head.x === food.x && head.y === food.y) {
    score += 10;
    scoreEl.textContent = 'Score: ' + score;
    placeFood();
    if (speed > 60) { speed -= 2; clearInterval(gameLoop); gameLoop = setInterval(() => { update(); draw(); }, speed); }
  } else {
    snake.pop();
  }
}

function start() {
  init();
  overlay.style.display = 'none';
  started = true;
  gameLoop = setInterval(() => { update(); draw(); }, speed);
}

document.addEventListener('keydown', e => {
  if (!started || gameOver) { start(); return; }
  const key = e.key.toLowerCase();
  if ((key === 'arrowup' || key === 'w') && dir.y === 0) nextDir = {x:0,y:-1};
  if ((key === 'arrowdown' || key === 's') && dir.y === 0) nextDir = {x:0,y:1};
  if ((key === 'arrowleft' || key === 'a') && dir.x === 0) nextDir = {x:-1,y:0};
  if ((key === 'arrowright' || key === 'd') && dir.x === 0) nextDir = {x:1,y:0};
  e.preventDefault();
});

// Touch controls
let touchStart = null;
document.addEventListener('touchstart', e => {
  if (!started || gameOver) { start(); return; }
  touchStart = {x: e.touches[0].clientX, y: e.touches[0].clientY};
});
document.addEventListener('touchend', e => {
  if (!touchStart) return;
  const dx = e.changedTouches[0].clientX - touchStart.x;
  const dy = e.changedTouches[0].clientY - touchStart.y;
  if (Math.abs(dx) > Math.abs(dy)) {
    if (dx > 0 && dir.x === 0) nextDir = {x:1,y:0};
    else if (dx < 0 && dir.x === 0) nextDir = {x:-1,y:0};
  } else {
    if (dy > 0 && dir.y === 0) nextDir = {x:0,y:1};
    else if (dy < 0 && dir.y === 0) nextDir = {x:0,y:-1};
  }
  touchStart = null;
});

init(); draw();
</script>
</body></html>
