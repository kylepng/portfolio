<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kyle | Desktop</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Cdefs%3E%3ClinearGradient id='r' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ff5f5f'/%3E%3Cstop offset='100%25' stop-color='%23cc0000'/%3E%3C/linearGradient%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%2355ff55'/%3E%3Cstop offset='100%25' stop-color='%2300aa00'/%3E%3C/linearGradient%3E%3ClinearGradient id='b' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%235599ff'/%3E%3Cstop offset='100%25' stop-color='%230044cc'/%3E%3C/linearGradient%3E%3ClinearGradient id='y' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' stop-color='%23ffee55'/%3E%3Cstop offset='100%25' stop-color='%23ccaa00'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='2' y='2' width='13' height='13' rx='2' fill='url(%23r)'/%3E%3Crect x='17' y='2' width='13' height='13' rx='2' fill='url(%23g)'/%3E%3Crect x='2' y='17' width='13' height='13' rx='2' fill='url(%23b)'/%3E%3Crect x='17' y='17' width='13' height='13' rx='2' fill='url(%23y)'/%3E%3C/svg%3E">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Pixelify+Sans&display=swap');

    @font-face {
      font-family: 'MS Sans Serif';
      src: local('Microsoft Sans Serif'), local('Tahoma'), local('Arial');
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* XP Cursor */
    .desktop, .desktop * {
      cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Cpath d='M4 4 L4 28 L10 22 L14 30 L18 28 L14 20 L22 20 Z' fill='white' stroke='black' stroke-width='1.5'/%3E%3C/svg%3E") 4 4, auto;
    }

    body {
      font-family: 'Tahoma', 'MS Sans Serif', sans-serif;
      overflow: hidden;
      height: 100vh;
      user-select: none;
    }

    /* Three.js Background Canvas */
    #three-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    /* Windows XP Bliss Wallpaper - Animated */
    .desktop {
      width: 100vw;
      height: 100vh;
      background: url('https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExcHJxMnRhbmxoY3Fvbjc1bXgyNjZhazFsMWRpaTZrcnpncjh4cnNxdiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l3q2SH4Cmhh8F40jS/giphy.gif') center center;
      background-size: cover;
      position: relative;
      overflow: hidden;
    }

    /* CRT Scanline Effect */
    .crt-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.03),
        rgba(0, 0, 0, 0.03) 1px,
        transparent 1px,
        transparent 2px
      );
      opacity: 0.5;
    }

    /* Desktop Icons */
    .icons-container {
      position: absolute;
      top: 10px;
      left: 10px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      z-index: 10;
    }

    .desktop-icon {
      width: 75px;
      padding: 4px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      border: 1px solid transparent;
      transition: transform 0.1s;
    }

    .desktop-icon:hover {
      background: rgba(11, 97, 255, 0.3);
      border: 1px dotted rgba(11, 97, 255, 0.8);
    }

    .desktop-icon:active {
      transform: scale(0.95);
    }

    .desktop-icon.selected {
      background: rgba(11, 97, 255, 0.4);
      border: 1px dotted #0b61ff;
    }

    .desktop-icon.bounce {
      animation: iconBounce 0.3s ease;
    }

    @keyframes iconBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .desktop-icon img {
      width: 48px;
      height: 48px;
      image-rendering: auto;
      filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.3));
      transition: transform 0.2s;
    }

    .desktop-icon:hover img {
      transform: scale(1.1);
    }

    .desktop-icon span {
      color: white;
      font-size: 11px;
      text-align: center;
      text-shadow: 1px 1px 1px black, 1px 1px 2px black, 0 0 3px black;
      word-wrap: break-word;
      max-width: 70px;
      line-height: 1.2;
    }

    /* Windows XP Window */
    .window {
      position: absolute;
      background: #ece9d8;
      border-radius: 8px 8px 0 0;
      min-width: 400px;
      display: none;
      z-index: 100;
      box-shadow: 2px 2px 15px rgba(0,0,0,0.4), inset 0 0 0 1px rgba(255,255,255,0.1);
      transform-origin: center center;
    }

    .window.active {
      display: block;
      animation: windowOpen 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .window.closing {
      animation: windowClose 0.15s ease-in forwards;
    }

    .window.minimizing {
      animation: windowMinimize 0.3s ease-in forwards;
    }

    @keyframes windowOpen {
      0% { transform: scale(0.8); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes windowClose {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(0.8); opacity: 0; }
    }

    @keyframes windowMinimize {
      0% { transform: scale(1) translateY(0); opacity: 1; }
      100% { transform: scale(0.1) translateY(500px); opacity: 0; }
    }

    /* XP Title Bar */
    .window-titlebar {
      height: 30px;
      background: linear-gradient(180deg,
        #0058ee 0%, #3a93ff 4%, #288eff 6%, #127dff 8%,
        #036ffc 10%, #0262ee 14%, #0057e5 20%, #0054e3 24%,
        #0055eb 56%, #005bf5 66%, #026afe 76%, #0062ef 86%,
        #0052e1 92%, #0040c4 94%, #0040c5 100%);
      border-radius: 8px 8px 0 0;
      display: flex;
      align-items: center;
      padding: 0 3px 0 5px;
    }

    .window-titlebar img {
      width: 16px;
      height: 16px;
      margin-right: 4px;
    }

    .window-title {
      color: white;
      font-size: 13px;
      font-weight: bold;
      text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
    }

    .window-controls {
      display: flex;
      gap: 2px;
    }

    .window-btn {
      width: 21px;
      height: 21px;
      border: none;
      border-radius: 3px;
      font-size: 13px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: filter 0.1s;
    }

    .window-btn.minimize {
      background: linear-gradient(180deg, #3c8cf5 0%, #1b67d6 50%, #318cf8 100%);
      border: 1px solid #3169c6;
      color: white;
    }

    .window-btn.maximize {
      background: linear-gradient(180deg, #3c8cf5 0%, #1b67d6 50%, #318cf8 100%);
      border: 1px solid #3169c6;
      color: white;
    }

    .window-btn.close {
      background: linear-gradient(180deg, #e5a59e 0%, #c4433e 50%, #d6837e 100%);
      border: 1px solid #c24e4a;
      color: white;
    }

    .window-btn:hover {
      filter: brightness(1.2);
    }

    .window-btn:active {
      filter: brightness(0.9);
    }

    /* Window Menu Bar */
    .window-menubar {
      background: #ece9d8;
      border-bottom: 1px solid #aca899;
      padding: 2px 0;
      display: flex;
    }

    .menu-item {
      padding: 2px 8px;
      font-size: 11px;
      color: #000;
    }

    .menu-item:hover {
      background: #316ac5;
      color: white;
    }

    /* Window Content */
    .window-content {
      display: flex;
      background: white;
      min-height: 300px;
    }

    /* XP Sidebar */
    .xp-sidebar {
      width: 180px;
      background: linear-gradient(180deg, #6b90da 0%, #6184cd 5%, #4f79c8 20%, #4f79c8 100%);
      padding: 10px 12px;
    }

    .sidebar-section {
      background: linear-gradient(180deg, #87a9e8 0%, #6f96de 3%, #5482d5 6%, #4a7ccf 50%, #4073c9 100%);
      border-radius: 5px;
      margin-bottom: 10px;
      overflow: hidden;
    }

    .sidebar-header {
      background: linear-gradient(180deg, #fefefe 0%, #e9ecf4 100%);
      padding: 6px 10px;
      font-size: 11px;
      font-weight: bold;
      color: #215dc6;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .sidebar-content {
      padding: 8px 10px;
    }

    .sidebar-link {
      color: white;
      font-size: 11px;
      padding: 3px 0;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.1s;
    }

    .sidebar-link:hover {
      text-decoration: underline;
      padding-left: 3px;
    }

    /* Social Links */
    .social-link {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 3px;
      text-decoration: none;
      font-size: 11px;
      font-weight: bold;
      transition: all 0.15s;
      border: 1px solid;
    }

    .social-link.tiktok {
      background: linear-gradient(135deg, #000 0%, #333 100%);
      color: #fff;
      border-color: #000;
    }

    .social-link.tiktok:hover {
      background: linear-gradient(135deg, #fe2c55 0%, #25f4ee 100%);
      transform: scale(1.05);
    }

    .social-link.instagram {
      background: linear-gradient(135deg, #833ab4 0%, #fd1d1d 50%, #fcb045 100%);
      color: #fff;
      border-color: #833ab4;
    }

    .social-link.instagram:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(131, 58, 180, 0.4);
    }

    .social-link.youtube {
      background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
      color: #fff;
      border-color: #cc0000;
    }

    .social-link.youtube:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(255, 0, 0, 0.4);
    }

    .social-link.twitter {
      background: linear-gradient(135deg, #1DA1F2 0%, #0d8bd9 100%);
      color: #fff;
      border-color: #0d8bd9;
    }

    .social-link.twitter:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(29, 161, 242, 0.4);
    }

    .social-link.github {
      background: linear-gradient(135deg, #333 0%, #24292e 100%);
      color: #fff;
      border-color: #24292e;
    }

    .social-link.github:hover {
      transform: scale(1.05);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      padding: 15px;
      background: white;
      overflow-y: auto;
    }

    .content-header {
      font-size: 11px;
      color: #215dc6;
      font-weight: bold;
      padding-bottom: 5px;
      border-bottom: 1px solid #d5dff7;
      margin-bottom: 15px;
    }

    .project-info {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }

    .project-icon {
      width: 48px;
      height: 48px;
      transition: transform 0.3s;
    }

    .project-icon:hover {
      transform: rotate(5deg) scale(1.1);
    }

    .project-details h2 {
      font-size: 14px;
      color: #000;
      margin-bottom: 3px;
    }

    .project-details .tagline {
      font-size: 11px;
      color: #666;
      margin-bottom: 5px;
    }

    .project-badge {
      display: inline-block;
      padding: 2px 6px;
      font-size: 9px;
      font-weight: bold;
      border-radius: 2px;
      animation: badgePulse 2s infinite;
    }

    @keyframes badgePulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .badge-live { background: #d4edda; color: #155724; }
    .badge-beta { background: #fff3cd; color: #856404; }
    .badge-dev { background: #cce5ff; color: #004085; }

    .project-description {
      font-size: 11px;
      color: #333;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .features-box {
      background: linear-gradient(180deg, #f9f9f9 0%, #f0f0f0 100%);
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 3px;
    }

    .features-box h4 {
      font-size: 11px;
      color: #215dc6;
      margin-bottom: 8px;
    }

    .features-box ul {
      list-style: none;
      padding: 0;
    }

    .features-box li {
      font-size: 11px;
      padding: 3px 0;
      padding-left: 18px;
      position: relative;
      transition: all 0.2s;
    }

    .features-box li:hover {
      background: #e8f0fe;
      padding-left: 22px;
    }

    .features-box li::before {
      content: '‚úì';
      position: absolute;
      left: 0;
      color: #3a8f3a;
      font-weight: bold;
    }

    .project-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .xp-button {
      background: linear-gradient(180deg, #fff 0%, #ecebe5 90%, #d8d0c4 100%);
      border: 1px solid #003c74;
      border-radius: 3px;
      padding: 5px 16px;
      font-size: 11px;
      font-family: 'Tahoma', sans-serif;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.1s;
      box-shadow: 1px 1px 0 #fff inset, -1px -1px 0 #999 inset;
    }

    .xp-button:hover {
      background: linear-gradient(180deg, #fff 0%, #e3e9f5 90%, #cdd7ea 100%);
      border-color: #0055cc;
    }

    .xp-button:active {
      background: linear-gradient(180deg, #d8d0c4 0%, #ecebe5 10%, #fff 100%);
      box-shadow: -1px -1px 0 #fff inset, 1px 1px 0 #999 inset;
    }

    .xp-button.primary {
      background: linear-gradient(180deg, #fff 0%, #dde7f8 90%, #c4d6f2 100%);
      border-color: #003c74;
    }

    /* Progress Bar */
    .progress-container {
      margin: 15px 0;
    }

    .progress-label {
      font-size: 10px;
      color: #666;
      margin-bottom: 4px;
    }

    .progress-bar {
      height: 16px;
      background: #fff;
      border: 1px solid #919b9c;
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(180deg, #5ddd5d 0%, #2ecc2e 50%, #2eb82e 100%);
      transition: width 1s ease-out;
      position: relative;
    }

    .progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 5px,
        rgba(255,255,255,0.2) 5px,
        rgba(255,255,255,0.2) 10px
      );
      animation: progressStripes 0.5s linear infinite;
    }

    @keyframes progressStripes {
      0% { background-position: 0 0; }
      100% { background-position: 20px 0; }
    }

    /* Screenshot Gallery */
    .screenshot-gallery {
      display: flex;
      gap: 8px;
      margin: 10px 0;
      overflow-x: auto;
      padding: 5px;
    }

    .screenshot {
      width: 80px;
      height: 60px;
      background: #ddd;
      border: 2px solid #999;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .screenshot:hover {
      transform: scale(1.1);
      border-color: #316ac5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    /* XP Taskbar */
    .taskbar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30px;
      background: linear-gradient(180deg,
        #1f5bce 0%, #3987e8 3%, #246ee1 6%,
        #1863de 50%, #0d52b2 51%, #0d4dad 100%);
      display: flex;
      align-items: center;
      z-index: 1000;
    }

    /* XP Start Button */
    .start-button {
      height: 30px;
      padding: 0 15px 0 6px;
      background: linear-gradient(180deg,
        #3a9431 0%, #44a337 8%, #52b748 14%,
        #3a9431 30%, #3a9431 50%, #378a30 51%, #217d20 100%);
      border: none;
      border-radius: 0 10px 10px 0;
      color: white;
      font-weight: bold;
      font-size: 15px;
      font-style: italic;
      display: flex;
      align-items: center;
      gap: 5px;
      text-shadow: 1px 1px 1px rgba(0,0,0,0.4);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.3), 2px 0 3px rgba(0,0,0,0.2);
      transition: all 0.1s;
      letter-spacing: 0.5px;
    }

    .start-button:hover {
      background: linear-gradient(180deg,
        #4aab3e 0%, #56ba46 8%, #66cc56 14%,
        #4aab3e 30%, #4aab3e 50%, #46a33c 51%, #2e9d2d 100%);
    }

    .start-button:active, .start-button.pressed {
      background: linear-gradient(180deg,
        #2d8328 0%, #358e30 8%, #3fa238 14%,
        #2d8328 30%, #2d8328 50%, #297828 51%, #186c18 100%);
    }

    .start-button img {
      width: 22px;
      height: 22px;
      filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.3));
    }

    /* Quick Launch */
    .quick-launch {
      display: flex;
      align-items: center;
      padding: 0 8px;
      border-left: 1px solid #1b5abe;
      border-right: 1px solid #1b5abe;
      margin-left: 2px;
      height: 24px;
      gap: 3px;
    }

    .quick-launch-btn {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid transparent;
      border-radius: 3px;
      transition: all 0.1s;
    }

    .quick-launch-btn:hover {
      background: rgba(255,255,255,0.25);
      border: 1px solid rgba(255,255,255,0.5);
    }

    .quick-launch-btn:active {
      background: rgba(0,0,0,0.1);
    }

    .quick-launch-btn img {
      width: 18px;
      height: 18px;
    }

    /* Taskbar Apps */
    .taskbar-apps {
      display: flex;
      gap: 3px;
      margin-left: 5px;
      flex: 1;
      height: 24px;
      overflow: hidden;
    }

    .taskbar-app {
      min-width: 140px;
      max-width: 180px;
      height: 24px;
      background: linear-gradient(180deg,
        #3d95ff 0%, #1e72e8 6%, #1565dc 50%, #0b4bc1 51%, #0e4fc4 100%);
      border: 1px solid #0c3d9d;
      border-radius: 2px;
      padding: 0 8px;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.1s;
    }

    .taskbar-app:hover {
      background: linear-gradient(180deg,
        #5ca8ff 0%, #3d8df5 6%, #2f7feb 50%, #1a62d1 51%, #1e66d5 100%);
    }

    .taskbar-app.active {
      background: linear-gradient(180deg,
        #fff 0%, #e8e9ed 6%, #dcdfe5 50%, #b9bcc4 51%, #c8cad0 100%);
      border: 1px solid #0c3d9d;
    }

    .taskbar-app.active span {
      color: #000;
      text-shadow: none;
    }

    .taskbar-app img {
      width: 16px;
      height: 16px;
    }

    .taskbar-app span {
      color: white;
      font-size: 11px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 0 1px 1px rgba(0,0,0,0.3);
    }

    /* System Tray */
    .system-tray {
      display: flex;
      align-items: center;
      background: linear-gradient(180deg,
        #0e8bff 0%, #0774e8 20%, #0966d6 50%, #0251b8 51%, #0652bb 100%);
      height: 30px;
      padding: 0 12px 0 8px;
      gap: 5px;
      border-left: 1px solid #0b5bc2;
    }

    .tray-btn {
      padding: 2px 4px;
      border-radius: 2px;
      transition: all 0.1s;
      position: relative;
    }

    .tray-btn:hover {
      background: rgba(255,255,255,0.2);
    }

    .tray-btn:active {
      background: rgba(0,0,0,0.1);
    }

    .tray-btn.music-btn .tray-icon {
      transition: transform 0.3s;
    }

    .tray-btn.music-btn.playing .tray-icon {
      animation: musicPulse 0.5s ease infinite;
    }

    @keyframes musicPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    .tray-icon {
      width: 16px;
      height: 16px;
      display: block;
    }

    .system-time {
      color: white;
      font-family: 'Tahoma', sans-serif;
      font-size: 11px;
      font-weight: normal;
      padding: 3px 8px;
      border-radius: 0;
      text-shadow: none;
      transition: all 0.1s;
      letter-spacing: 0;
    }

    .system-time:hover {
      background: rgba(255,255,255,0.2);
    }

    /* Calendar Popup */
    .calendar-popup {
      position: absolute;
      bottom: 35px;
      right: 5px;
      background: #ece9d8;
      border: 2px solid #0054e3;
      border-radius: 5px;
      padding: 10px;
      display: none;
      z-index: 2001;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.4);
      min-width: 200px;
    }

    .calendar-popup.active {
      display: block;
      animation: popupSlide 0.2s ease-out;
    }

    @keyframes popupSlide {
      0% { transform: translateY(10px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }

    .calendar-header {
      text-align: center;
      font-weight: bold;
      font-size: 12px;
      margin-bottom: 10px;
      color: #215dc6;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
      font-size: 10px;
    }

    .calendar-day {
      text-align: center;
      padding: 4px;
      border-radius: 2px;
    }

    .calendar-day.header {
      font-weight: bold;
      color: #666;
    }

    .calendar-day.today {
      background: #316ac5;
      color: white;
      font-weight: bold;
    }

    .calendar-day:not(.header):not(.empty):hover {
      background: #e0e0e0;
    }

    /* WiFi Popup (Easter Egg) */
    .wifi-popup {
      position: absolute;
      bottom: 35px;
      right: 80px;
      background: #ece9d8;
      border: 2px solid #0054e3;
      border-radius: 5px;
      padding: 15px;
      display: none;
      z-index: 2001;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.4);
      width: 250px;
    }

    .wifi-popup.active {
      display: block;
      animation: popupSlide 0.2s ease-out;
    }

    .wifi-popup h3 {
      font-size: 12px;
      color: #215dc6;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .wifi-network {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 3px;
      margin-bottom: 5px;
      font-size: 11px;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.1s;
    }

    .wifi-network:hover {
      background: #e8f0fe;
      border-color: #316ac5;
    }

    .wifi-network.secret {
      background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
      background-size: 300% 100%;
      animation: rainbow 3s linear infinite;
      color: white;
      text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
      font-weight: bold;
    }

    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      100% { background-position: 300% 50%; }
    }

    /* Volume Popup */
    .volume-popup {
      position: absolute;
      bottom: 35px;
      right: 120px;
      background: #ece9d8;
      border: 2px solid #0054e3;
      border-radius: 5px;
      padding: 15px;
      display: none;
      z-index: 2001;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.4);
      width: 120px;
    }

    .volume-popup.active {
      display: block;
      animation: popupSlide 0.2s ease-out;
    }

    .volume-slider {
      width: 100%;
      height: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .volume-slider input[type="range"] {
      writing-mode: bt-lr;
      -webkit-appearance: slider-vertical;
      width: 20px;
      height: 60px;
    }

    .volume-label {
      font-size: 10px;
      color: #333;
      margin-top: 5px;
    }

    /* XP Start Menu */
    .start-menu {
      position: absolute;
      bottom: 30px;
      left: 0;
      width: 400px;
      background: #ece9d8;
      border: 2px solid #0054e3;
      border-radius: 5px 5px 0 0;
      display: none;
      z-index: 2000;
      box-shadow: 4px 4px 15px rgba(0,0,0,0.5);
      overflow: hidden;
    }

    .start-menu.active {
      display: block;
      animation: startMenuOpen 0.2s ease-out;
    }

    @keyframes startMenuOpen {
      0% { transform: translateY(20px) scale(0.95); opacity: 0; }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }

    .start-header {
      background: linear-gradient(180deg,
        #0058ee 0%, #3a93ff 4%, #288eff 8%,
        #036ffc 12%, #0054e3 50%, #0055eb 80%, #0040c5 100%);
      padding: 10px 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-radius: 3px 3px 0 0;
    }

    .start-avatar {
      width: 52px;
      height: 52px;
      border: 2px solid white;
      border-radius: 5px;
      background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 24px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
      transition: transform 0.2s;
    }

    .start-avatar:hover {
      transform: scale(1.05);
    }

    .start-user {
      color: white;
      font-size: 16px;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    }

    .start-content {
      display: flex;
    }

    .start-left {
      width: 200px;
      background: white;
      padding: 6px 0;
      border-right: 1px solid #d5d2c8;
    }

    .start-right {
      width: 200px;
      background: linear-gradient(180deg, #d3e5fa 0%, #b8d4f8 100%);
      padding: 6px 0;
    }

    .start-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px 12px;
      transition: all 0.1s;
    }

    .start-item:hover {
      background: #316ac5;
    }

    .start-item:hover span {
      color: white;
    }

    .start-item:hover img {
      transform: scale(1.1);
    }

    .start-item img {
      width: 32px;
      height: 32px;
      transition: transform 0.2s;
    }

    .start-item.small img {
      width: 20px;
      height: 20px;
    }

    .start-item span {
      font-size: 12px;
      color: #000;
    }

    .start-item.small span {
      font-size: 11px;
    }

    .start-separator {
      height: 1px;
      background: linear-gradient(90deg, transparent, #d5d2c8, transparent);
      margin: 6px 12px;
    }

    .start-right .start-item span {
      font-weight: bold;
    }

    .all-programs {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 12px;
      border-top: 1px solid #d5d2c8;
      margin-top: 5px;
    }

    .all-programs span {
      font-size: 12px;
      font-weight: bold;
      color: #215dc6;
    }

    .all-programs:hover {
      background: #316ac5;
    }

    .all-programs:hover span {
      color: white;
    }

    .start-footer {
      background: linear-gradient(180deg, #4488e5 0%, #3172d6 50%, #2260c4 100%);
      padding: 8px 12px;
      display: flex;
      justify-content: flex-end;
      gap: 20px;
    }

    .footer-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 3px;
      transition: all 0.1s;
    }

    .footer-btn:hover {
      background: rgba(255,255,255,0.2);
    }

    .footer-btn img {
      width: 28px;
      height: 28px;
    }

    .footer-btn span {
      color: white;
      font-size: 12px;
      text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
    }

    /* Shutdown Dialog */
    .shutdown-dialog {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 3000;
    }

    .shutdown-dialog.active {
      display: flex;
      animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }

    .shutdown-box {
      background: linear-gradient(180deg, #3c8cf5 0%, #1b67d6 100%);
      border-radius: 10px;
      padding: 20px 30px;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      animation: dialogPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes dialogPop {
      0% { transform: scale(0.8); }
      100% { transform: scale(1); }
    }

    .shutdown-box h2 {
      color: white;
      font-size: 16px;
      margin-bottom: 15px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    }

    .shutdown-options {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }

    .shutdown-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 15px 20px;
      border-radius: 5px;
      transition: all 0.2s;
    }

    .shutdown-option:hover {
      background: rgba(255,255,255,0.2);
      transform: scale(1.05);
    }

    .shutdown-option img {
      width: 48px;
      height: 48px;
    }

    .shutdown-option span {
      color: white;
      font-size: 11px;
      font-weight: bold;
    }

    .shutdown-cancel {
      background: linear-gradient(180deg, #fff 0%, #ecebe5 90%, #d8d0c4 100%);
      border: 1px solid #003c74;
      border-radius: 3px;
      padding: 6px 20px;
      font-size: 11px;
      font-family: 'Tahoma', sans-serif;
    }

    .shutdown-cancel:hover {
      background: linear-gradient(180deg, #fff 0%, #e3e9f5 90%, #cdd7ea 100%);
    }

    /* Marquee Text */
    .marquee {
      overflow: hidden;
      white-space: nowrap;
      margin: 10px 0;
    }

    .marquee span {
      display: inline-block;
      animation: marquee 10s linear infinite;
      font-size: 10px;
      color: #666;
    }

    @keyframes marquee {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }

    /* Blinking Cursor */
    .blink {
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }

    /* Typing Animation */
    .typing {
      overflow: hidden;
      border-right: 2px solid #333;
      white-space: nowrap;
      animation: typing 2s steps(30) forwards, blinkCursor 0.7s step-end infinite;
    }

    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blinkCursor {
      50% { border-color: transparent; }
    }

    /* Notification */
    .notification {
      position: fixed;
      bottom: 40px;
      right: 10px;
      background: #ffffcc;
      border: 1px solid #999;
      border-radius: 5px;
      padding: 10px 15px;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.2);
      display: none;
      z-index: 2500;
      max-width: 250px;
      animation: notificationSlide 0.3s ease-out;
    }

    .notification.active {
      display: block;
    }

    @keyframes notificationSlide {
      0% { transform: translateX(100%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }

    .notification-title {
      font-size: 11px;
      font-weight: bold;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .notification-body {
      font-size: 10px;
      color: #333;
    }

    /* Boot Screen */
    .boot-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }

    .boot-screen.hidden {
      display: none;
    }

    .boot-logo {
      margin-bottom: 30px;
    }

    .boot-logo img {
      width: 300px;
    }

    .boot-text {
      color: white;
      font-size: 12px;
      margin-bottom: 20px;
    }

    .boot-progress {
      width: 200px;
      height: 20px;
      background: #333;
      border-radius: 10px;
      overflow: hidden;
    }

    .boot-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #0058ee, #3a93ff, #0058ee);
      background-size: 200% 100%;
      animation: bootProgress 2s ease-in-out forwards, shimmer 1s linear infinite;
      width: 0%;
    }

    @keyframes bootProgress {
      0% { width: 0%; }
      100% { width: 100%; }
    }

    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    /* Screensaver */
    .screensaver {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: none;
      z-index: 9000;
    }

    .screensaver.active {
      display: block;
    }

    .screensaver-text {
      position: absolute;
      color: #0f0;
      font-size: 24px;
      font-family: 'Courier New', monospace;
      text-shadow: 0 0 10px #0f0;
      animation: floatText 20s linear infinite;
    }

    @keyframes floatText {
      0% { transform: translate(0, 0); }
      25% { transform: translate(calc(100vw - 200px), calc(50vh - 20px)); }
      50% { transform: translate(calc(50vw - 100px), calc(100vh - 50px)); }
      75% { transform: translate(calc(80vw - 150px), calc(30vh - 20px)); }
      100% { transform: translate(0, 0); }
    }
  </style>
</head>
<body>
  <!-- Boot Screen -->
  <div class="boot-screen" id="boot-screen">
    <div class="boot-logo">
      <svg width="300" height="80" viewBox="0 0 300 80">
        <text x="10" y="50" fill="#fff" font-size="28" font-weight="bold" font-family="Arial">Microsoft</text>
        <text x="150" y="50" fill="#ff6600" font-size="28" font-style="italic" font-family="Arial">Windows</text>
        <text x="260" y="35" fill="#ff6600" font-size="14" font-family="Arial">XP</text>
      </svg>
    </div>
    <div class="boot-text">Kyle Portfolio Loading...</div>
    <div class="boot-progress">
      <div class="boot-progress-bar" id="boot-progress"></div>
    </div>
  </div>

  <!-- Three.js Background -->
  <canvas id="three-bg"></canvas>

  <!-- CRT Scanline Overlay -->
  <div class="crt-overlay"></div>

  <div class="desktop" id="desktop" style="display: none;">
    <!-- Desktop Icons - Authentic XP Style -->
    <div class="icons-container">
      <div class="desktop-icon" data-window="pepmaxx" ondblclick="openWindow('pepmaxx')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/help_book_cool-0.png">
        <span>PepMaxx</span>
      </div>

      <div class="desktop-icon" data-window="peakrevival" ondblclick="openWindow('peakrevival')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/briefcase-0.png">
        <span>Peak Revival-X</span>
      </div>

      <div class="desktop-icon" data-window="autoflow" ondblclick="openWindow('autoflow')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/settings_gear-0.png">
        <span>Auto Flow v8</span>
      </div>

      <div class="desktop-icon" data-window="sigmavideo" ondblclick="openWindow('sigmavideo')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/video_file-0.png">
        <span>Sigma Video</span>
      </div>

      <div class="desktop-icon" data-window="freemeals" ondblclick="openWindow('freemeals')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/users-0.png">
        <span>Free Meals</span>
      </div>

      <div class="desktop-icon" data-window="about" ondblclick="openWindow('about')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/user-0.png">
        <span>About Me</span>
      </div>

      <div class="desktop-icon" ondblclick="window.open('https://github.com/kylepng', '_blank'); playClick();" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/html-0.png">
        <span>GitHub</span>
      </div>

      <div class="desktop-icon" data-window="socials" ondblclick="openWindow('socials')" onclick="selectIcon(this); playClick();">
        <img src="https://win98icons.alexmeub.com/icons/png/directory_closed-4.png">
        <span>My Socials</span>
      </div>
    </div>

    <!-- PepMaxx Window -->
    <div class="window" id="window-pepmaxx" style="top: 60px; left: 180px; width: 600px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-pepmaxx')">
        <img src="https://win98icons.alexmeub.com/icons/png/help_book_cool-0.png" style="width:16px;height:16px;">
        <span class="window-title">PepMaxx - Peptide Tracker</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('pepmaxx')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('pepmaxx')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('pepmaxx')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item" onclick="playClick()">File</span>
        <span class="menu-item" onclick="playClick()">Edit</span>
        <span class="menu-item" onclick="playClick()">View</span>
        <span class="menu-item" onclick="playClick()">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">üìã Project Tasks</div>
            <div class="sidebar-content">
              <div class="sidebar-link" onclick="playClick()">üì± View TestFlight</div>
              <div class="sidebar-link" onclick="playClick()">üíª Source Code</div>
              <div class="sidebar-link" onclick="playClick()">üìñ Documentation</div>
            </div>
          </div>
          <div class="sidebar-section">
            <div class="sidebar-header">‚ÑπÔ∏è Details</div>
            <div class="sidebar-content">
              <div class="sidebar-link">Platform: iOS/Android</div>
              <div class="sidebar-link">Stack: Expo RN</div>
              <div class="sidebar-link">Status: Beta</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">Project Information</div>
          <div class="project-info">
            <img class="project-icon" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><defs><linearGradient id='pg1' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' stop-color='%2334d058'/><stop offset='100%' stop-color='%23166534'/></linearGradient></defs><rect fill='url(%23pg1)' rx='6' width='48' height='48'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='22'>üíä</text></svg>">
            <div class="project-details">
              <h2>PepMaxx</h2>
              <p class="tagline">Premium Peptide Tracking App</p>
              <span class="project-badge badge-beta">TestFlight Beta</span>
            </div>
          </div>
          <p class="project-description">
            The ultimate iOS/Android app for tracking peptides, calculating doses, and managing protocols. Features "Peppy" - an AI assistant.
          </p>
          <div class="progress-container">
            <div class="progress-label">Development Progress: 85%</div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: 85%"></div>
            </div>
          </div>
          <div class="features-box">
            <h4>Features</h4>
            <ul>
              <li>50+ peptide library</li>
              <li>Smart dose calculator</li>
              <li>Protocol tracking</li>
              <li>AI assistant "Peppy"</li>
              <li>Vendor affiliates</li>
            </ul>
          </div>
          <div class="screenshot-gallery">
            <div class="screenshot">üì±</div>
            <div class="screenshot">üíâ</div>
            <div class="screenshot">üìä</div>
            <div class="screenshot">ü§ñ</div>
          </div>
          <div class="project-buttons">
            <button class="xp-button primary" onclick="playClick()">üçé TestFlight</button>
            <button class="xp-button" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">üìÇ GitHub</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Peak Revival Window -->
    <div class="window" id="window-peakrevival" style="top: 80px; left: 220px; width: 580px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-peakrevival')">
        <img src="https://win98icons.alexmeub.com/icons/png/briefcase-0.png" style="width:16px;height:16px;">
        <span class="window-title">Peak Revival-X - TikTok Shop</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('peakrevival')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('peakrevival')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('peakrevival')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">üõí Shop</div>
            <div class="sidebar-content">
              <div class="sidebar-link">üõçÔ∏è TikTok Shop</div>
              <div class="sidebar-link">üìä Analytics</div>
              <div class="sidebar-link">üì¶ Inventory</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">Shop Information</div>
          <div class="project-info">
            <img class="project-icon" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><defs><linearGradient id='pg2' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' stop-color='%23fbbf24'/><stop offset='100%' stop-color='%23d97706'/></linearGradient></defs><rect fill='url(%23pg2)' rx='6' width='48' height='48'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>üè™</text></svg>">
            <div class="project-details">
              <h2>Peak Revival-X</h2>
              <p class="tagline">Premium Supplements</p>
              <span class="project-badge badge-live">LIVE</span>
            </div>
          </div>
          <div class="marquee">
            <span>üî• HOT DEALS: Turkesterone 20% OFF | Free Shipping on orders $50+ | New: Sulforaphane now in stock! üî•</span>
          </div>
          <div class="features-box">
            <h4>Products</h4>
            <ul>
              <li>Turkesterone</li>
              <li>Fadogia Agrestis</li>
              <li>Creatine Monohydrate</li>
              <li>TUDCA</li>
              <li>Shilajit & Sulforaphane</li>
            </ul>
          </div>
          <div class="project-buttons">
            <button class="xp-button primary" onclick="playClick()">üéµ TikTok Shop</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Auto Flow Window -->
    <div class="window" id="window-autoflow" style="top: 50px; left: 260px; width: 620px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-autoflow')">
        <img src="https://win98icons.alexmeub.com/icons/png/settings_gear-0.png" style="width:16px;height:16px;">
        <span class="window-title">Auto Flow + Nano Banana Pro v8.0</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('autoflow')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('autoflow')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('autoflow')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Tools</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">‚ö° Actions</div>
            <div class="sidebar-content">
              <div class="sidebar-link">üì• Install</div>
              <div class="sidebar-link">üìñ Guide</div>
              <div class="sidebar-link">üêõ Report Bug</div>
            </div>
          </div>
          <div class="sidebar-section">
            <div class="sidebar-header">üìä Version</div>
            <div class="sidebar-content">
              <div class="sidebar-link">v8.0.0</div>
              <div class="sidebar-link">2024</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">Extension Details</div>
          <div class="project-info">
            <img class="project-icon" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><defs><linearGradient id='pg3' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' stop-color='%2300d4ff'/><stop offset='100%' stop-color='%230891b2'/></linearGradient></defs><rect fill='url(%23pg3)' rx='6' width='48' height='48'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>ü§ñ</text></svg>">
            <div class="project-details">
              <h2>Auto Flow v8.0</h2>
              <p class="tagline">+ Nano Banana Pro</p>
              <span class="project-badge badge-live">v8.0.0</span>
            </div>
          </div>
          <p class="project-description">
            Chrome extension for Google Flow AI - unlimited videos and images with Veo 3.1 and Nano Banana Pro.
          </p>
          <div class="features-box">
            <h4>v8.0 Features</h4>
            <ul>
              <li>Video Gallery (0.5x-6x speed)</li>
              <li>Double-click expand</li>
              <li>Retry Failed button</li>
              <li>Rate limit auto-retry</li>
              <li>Rainbow RGB gateway</li>
            </ul>
          </div>
          <div class="project-buttons">
            <button class="xp-button primary" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">üìÇ GitHub</button>
            <button class="xp-button" onclick="playClick()">üîß Install</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Sigma Video Window -->
    <div class="window" id="window-sigmavideo" style="top: 100px; left: 300px; width: 560px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-sigmavideo')">
        <img src="https://win98icons.alexmeub.com/icons/png/video_file-0.png" style="width:16px;height:16px;">
        <span class="window-title">Sigma Video Gen</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('sigmavideo')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('sigmavideo')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('sigmavideo')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">üé¨ Pipeline</div>
            <div class="sidebar-content">
              <div class="sidebar-link">üìù Scripts</div>
              <div class="sidebar-link">üéôÔ∏è Voiceovers</div>
              <div class="sidebar-link">üñºÔ∏è Images</div>
              <div class="sidebar-link">üéûÔ∏è Videos</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">AI Video Pipeline</div>
          <div class="project-info">
            <img class="project-icon" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><defs><linearGradient id='pg4' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' stop-color='%238b5cf6'/><stop offset='100%' stop-color='%236d28d9'/></linearGradient></defs><rect fill='url(%23pg4)' rx='6' width='48' height='48'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>üé¨</text></svg>">
            <div class="project-details">
              <h2>Sigma Video Gen</h2>
              <p class="tagline">AI Video for TikTok</p>
              <span class="project-badge badge-dev">Active</span>
            </div>
          </div>
          <p class="project-description">
            Automated AI video generation. ElevenLabs voiceover, Gemini images, Veo video.
          </p>
          <div class="features-box">
            <h4>Capabilities</h4>
            <ul>
              <li>Script to video automation</li>
              <li>Word-level timestamps</li>
              <li>Multiple formats</li>
              <li>VA assignment system</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Free Meals Window -->
    <div class="window" id="window-freemeals" style="top: 70px; left: 200px; width: 540px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-freemeals')">
        <img src="https://win98icons.alexmeub.com/icons/png/users-0.png" style="width:16px;height:16px;">
        <span class="window-title">Free Meals on Wheels</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('freemeals')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('freemeals')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('freemeals')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">‚ù§Ô∏è Non-Profit</div>
            <div class="sidebar-content">
              <div class="sidebar-link">üôã Volunteer</div>
              <div class="sidebar-link">üí∞ Donate</div>
              <div class="sidebar-link">üìç Locations</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">App Information</div>
          <div class="project-info">
            <img class="project-icon" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><defs><linearGradient id='pg5' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' stop-color='%23f472b6'/><stop offset='100%' stop-color='%23db2777'/></linearGradient></defs><rect fill='url(%23pg5)' rx='6' width='48' height='48'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>‚ù§Ô∏è</text></svg>">
            <div class="project-details">
              <h2>Free Meals on Wheels</h2>
              <p class="tagline">Non-Profit App</p>
              <span class="project-badge badge-dev">In Development</span>
            </div>
          </div>
          <div class="features-box">
            <h4>Features</h4>
            <ul>
              <li>Volunteer coordination</li>
              <li>Donation tracking</li>
              <li>Food distribution</li>
              <li>Impact reporting</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- About Window -->
    <div class="window" id="window-about" style="top: 90px; left: 320px; width: 540px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-about')">
        <img src="https://win98icons.alexmeub.com/icons/png/user-0.png" style="width:16px;height:16px;">
        <span class="window-title">About Kyle</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('about')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('about')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('about')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content">
        <div class="xp-sidebar">
          <div class="sidebar-section">
            <div class="sidebar-header">üîó Links</div>
            <div class="sidebar-content">
              <div class="sidebar-link" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">üêô GitHub</div>
              <div class="sidebar-link" onclick="window.open('https://tiktok.com/@somnicore', '_blank'); playClick();">üéµ TikTok</div>
              <div class="sidebar-link" onclick="playClick()">‚úâÔ∏è Contact</div>
            </div>
          </div>
        </div>
        <div class="main-content">
          <div class="content-header">Developer Profile</div>
          <div class="project-info">
            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #00d4ff 0%, #7c3aed 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: white; font-size: 22px; font-weight: bold;">K</div>
            <div class="project-details">
              <h2>Kyle</h2>
              <p class="tagline">@somnicore</p>
            </div>
          </div>
          <p class="project-description">
            Marketing on TikTok. Scaling businesses with TikTok and UGC. Building with Claude Code.
          </p>
          <div class="features-box">
            <h4>Skills</h4>
            <ul>
              <li>TikTok Marketing</li>
              <li>Claude Code</li>
              <li>Scaling Businesses with TikTok</li>
              <li>UGC Content Creation</li>
            </ul>
          </div>
          <div class="project-buttons">
            <button class="xp-button primary" onclick="window.open('https://tiktok.com/@somnicore', '_blank'); playClick();">üéµ TikTok</button>
            <button class="xp-button" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">üêô GitHub</button>
          </div>
        </div>
      </div>
    </div>

    <!-- My Socials Window -->
    <div class="window" id="window-socials" style="top: 50px; left: 200px; width: 580px;">
      <div class="window-titlebar" onmousedown="startDrag(event, 'window-socials')">
        <img src="https://win98icons.alexmeub.com/icons/png/directory_open_file_mydocs-4.png" style="width:16px;height:16px;">
        <span class="window-title">My Socials - Windows Explorer</span>
        <div class="window-controls">
          <button class="window-btn minimize" onclick="minimizeWindow('socials')">_</button>
          <button class="window-btn maximize" onclick="maximizeWindow('socials')">‚ñ°</button>
          <button class="window-btn close" onclick="closeWindow('socials')">‚úï</button>
        </div>
      </div>
      <div class="window-menubar">
        <span class="menu-item">File</span>
        <span class="menu-item">Edit</span>
        <span class="menu-item">View</span>
        <span class="menu-item">Favorites</span>
        <span class="menu-item">Help</span>
      </div>
      <div class="window-content" style="padding: 12px; max-height: 450px; overflow-y: auto;">
        <div style="background: #fff; border: 1px solid #808080; padding: 10px; margin-bottom: 12px;">
          <div style="font-weight: bold; color: #0054e3; margin-bottom: 8px; font-size: 14px;">üì± TikTok</div>
          <div style="display: flex; flex-wrap: wrap; gap: 6px;">
            <a href="https://tiktok.com/@ergophobian" target="_blank" class="social-link tiktok">@ergophobian</a>
            <a href="https://tiktok.com/@somni.core" target="_blank" class="social-link tiktok">@somni.core</a>
            <a href="https://tiktok.com/@ryangrowthdaily" target="_blank" class="social-link tiktok">@ryangrowthdaily</a>
            <a href="https://tiktok.com/@pepmaxx" target="_blank" class="social-link tiktok">@pepmaxx</a>
            <a href="https://tiktok.com/@lukemaxxin" target="_blank" class="social-link tiktok">@lukemaxxin</a>
            <a href="https://tiktok.com/@insanedealss" target="_blank" class="social-link tiktok">@insanedealss</a>
          </div>
        </div>
        <div style="background: #fff; border: 1px solid #808080; padding: 10px; margin-bottom: 12px;">
          <div style="font-weight: bold; color: #E1306C; margin-bottom: 8px; font-size: 14px;">üì∏ Instagram</div>
          <div style="display: flex; flex-wrap: wrap; gap: 6px;">
            <a href="https://instagram.com/somnicore" target="_blank" class="social-link instagram">@somnicore</a>
            <a href="https://instagram.com/pepmaxxing" target="_blank" class="social-link instagram">@pepmaxxing</a>
            <a href="https://instagram.com/pepmaxxer" target="_blank" class="social-link instagram">@pepmaxxer</a>
          </div>
        </div>
        <div style="background: #fff; border: 1px solid #808080; padding: 10px; margin-bottom: 12px;">
          <div style="font-weight: bold; color: #FF0000; margin-bottom: 8px; font-size: 14px;">‚ñ∂Ô∏è YouTube</div>
          <div style="display: flex; flex-wrap: wrap; gap: 6px;">
            <a href="https://youtube.com/@somnicoree" target="_blank" class="social-link youtube">@somnicoree</a>
            <a href="https://youtube.com/@paliossystems" target="_blank" class="social-link youtube">@paliossystems</a>
            <a href="https://youtube.com/@zafraharvestskincare" target="_blank" class="social-link youtube">@zafraharvestskincare</a>
            <a href="https://youtube.com/@ergophobian2" target="_blank" class="social-link youtube">@ergophobian2</a>
            <a href="https://youtube.com/@zafraskin" target="_blank" class="social-link youtube">@zafraskin</a>
          </div>
        </div>
        <div style="background: #fff; border: 1px solid #808080; padding: 10px; margin-bottom: 12px;">
          <div style="font-weight: bold; color: #1DA1F2; margin-bottom: 8px; font-size: 14px;">ùïè X / Twitter</div>
          <div style="display: flex; flex-wrap: wrap; gap: 6px;">
            <a href="https://x.com/indefatigabile" target="_blank" class="social-link twitter">@indefatigabile</a>
            <a href="https://x.com/somnicore" target="_blank" class="social-link twitter">@somnicore</a>
            <a href="https://x.com/pepmaxx" target="_blank" class="social-link twitter">@pepmaxx</a>
          </div>
        </div>
        <div style="background: #fff; border: 1px solid #808080; padding: 10px;">
          <div style="font-weight: bold; color: #333; margin-bottom: 8px; font-size: 14px;">üêô GitHub</div>
          <div style="display: flex; flex-wrap: wrap; gap: 6px;">
            <a href="https://github.com/kylepng" target="_blank" class="social-link github">@kylepng</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
      <button class="start-button" id="start-btn" onclick="toggleStartMenu(); playStartSound();">
        <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'><rect fill='%23ff0000' x='1' y='1' width='8' height='8' rx='1'/><rect fill='%2300cc00' x='11' y='1' width='8' height='8' rx='1'/><rect fill='%230066ff' x='1' y='11' width='8' height='8' rx='1'/><rect fill='%23ffcc00' x='11' y='11' width='8' height='8' rx='1'/></svg>">
        start
      </button>
      <div class="quick-launch">
        <div class="quick-launch-btn" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">
          <img src="https://win98icons.alexmeub.com/icons/png/html-0.png">
        </div>
        <div class="quick-launch-btn" onclick="openWindow('socials'); playClick();">
          <img src="https://win98icons.alexmeub.com/icons/png/directory_open_file_mydocs-4.png">
        </div>
        <div class="quick-launch-btn" onclick="openWindow('about'); playClick();">
          <img src="https://win98icons.alexmeub.com/icons/png/user-0.png">
        </div>
      </div>
      <div class="taskbar-apps" id="taskbar-apps"></div>
      <div class="system-tray">
        <div class="tray-btn music-btn" id="music-btn" onclick="toggleMusic(); playClick();" title="Toggle Background Music">
          <img class="tray-icon" src="https://win98icons.alexmeub.com/icons/png/cd_audio_cd_a-4.png">
        </div>
        <div class="tray-btn" onclick="toggleVolume(); playClick();">
          <img class="tray-icon" src="https://win98icons.alexmeub.com/icons/png/loudspeaker_rays-0.png">
        </div>
        <div class="tray-btn" onclick="toggleWifi(); playClick();" title="Click for a surprise!">
          <img class="tray-icon" src="https://win98icons.alexmeub.com/icons/png/modem-5.png">
        </div>
        <span class="system-time" id="clock" onclick="toggleCalendar(); playClick();"></span>
      </div>
    </div>

    <!-- Start Menu -->
    <div class="start-menu" id="start-menu">
      <div class="start-header">
        <div class="start-avatar">K</div>
        <span class="start-user">Kyle</span>
      </div>
      <div class="start-content">
        <div class="start-left">
          <div class="start-item" onclick="openWindow('pepmaxx'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/help_book_cool-0.png">
            <span>PepMaxx</span>
          </div>
          <div class="start-item" onclick="openWindow('autoflow'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/settings_gear-0.png">
            <span>Auto Flow v8</span>
          </div>
          <div class="start-item" onclick="openWindow('sigmavideo'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/video_file-0.png">
            <span>Sigma Video Gen</span>
          </div>
          <div class="start-item" onclick="openWindow('peakrevival'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/briefcase-0.png">
            <span>Peak Revival-X</span>
          </div>
          <div class="start-separator"></div>
          <div class="start-item small" onclick="openWindow('freemeals'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/users-0.png">
            <span>Free Meals on Wheels</span>
          </div>
          <div class="all-programs" onclick="playClick();">
            <span>All Programs</span>
            <span>‚ñ∂</span>
          </div>
        </div>
        <div class="start-right">
          <div class="start-item small" onclick="openWindow('about'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/user-0.png">
            <span>About Me</span>
          </div>
          <div class="start-item small" onclick="openWindow('socials'); toggleStartMenu(); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/directory_open_file_mydocs-4.png">
            <span>My Socials</span>
          </div>
          <div class="start-item small" onclick="window.open('https://github.com/kylepng', '_blank'); playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/html-0.png">
            <span>GitHub</span>
          </div>
          <div class="start-separator"></div>
          <div class="start-item small" onclick="playClick();">
            <img src="https://win98icons.alexmeub.com/icons/png/settings_gear-0.png">
            <span>Control Panel</span>
          </div>
        </div>
      </div>
      <div class="start-footer">
        <div class="footer-btn" onclick="showNotification('Log Off', 'Logging off Kyle...'); playClick();">
          <img src="https://win98icons.alexmeub.com/icons/png/key_win-0.png">
          <span>Log Off</span>
        </div>
        <div class="footer-btn" onclick="showShutdown(); playClick();">
          <img src="https://win98icons.alexmeub.com/icons/png/shut_down_normal-0.png">
          <span>Turn Off</span>
        </div>
      </div>
    </div>

    <!-- Calendar Popup -->
    <div class="calendar-popup" id="calendar-popup">
      <div class="calendar-header" id="calendar-month"></div>
      <div class="calendar-grid" id="calendar-grid"></div>
    </div>

    <!-- WiFi Popup (Easter Egg) -->
    <div class="wifi-popup" id="wifi-popup">
      <h3>üì∂ Wireless Networks</h3>
      <div class="wifi-network">üì∂ Home_WiFi_5G (Connected)</div>
      <div class="wifi-network">üì∂ Neighbor_Network</div>
      <div class="wifi-network">üì∂ FBI_Surveillance_Van</div>
      <div class="wifi-network secret" onclick="showNotification('üéâ Easter Egg!', 'You found the secret! Kyle is awesome. üöÄ'); playClick();">
        ‚ú® CLICK_ME_FOR_A_SURPRISE ‚ú®
      </div>
    </div>

    <!-- Volume Popup -->
    <div class="volume-popup" id="volume-popup">
      <div class="volume-slider">
        <input type="range" min="0" max="100" value="80" id="volume-slider" onchange="updateVolume(this.value)">
        <div class="volume-label">Volume: <span id="volume-value">80</span>%</div>
      </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
      <div class="notification-title"><span id="notif-icon">‚ÑπÔ∏è</span> <span id="notif-title">Notification</span></div>
      <div class="notification-body" id="notif-body">Message here</div>
    </div>
  </div>

  <!-- Shutdown Dialog -->
  <div class="shutdown-dialog" id="shutdown-dialog">
    <div class="shutdown-box">
      <h2>What do you want the computer to do?</h2>
      <div class="shutdown-options">
        <div class="shutdown-option" onclick="playClick(); window.location.reload();">
          <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><circle fill='%234CAF50' cx='24' cy='24' r='20'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>üîÑ</text></svg>">
          <span>Restart</span>
        </div>
        <div class="shutdown-option" onclick="triggerShutdown();">
          <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><circle fill='%23ef4444' cx='24' cy='24' r='20'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>‚èª</text></svg>">
          <span>Shut Down</span>
        </div>
        <div class="shutdown-option" onclick="startScreensaver(); hideShutdown();">
          <img src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'><circle fill='%233498db' cx='24' cy='24' r='20'/><text x='50%' y='58%' text-anchor='middle' fill='white' font-size='20'>üò¥</text></svg>">
          <span>Stand By</span>
        </div>
      </div>
      <button class="shutdown-cancel" onclick="hideShutdown(); playClick();">Cancel</button>
    </div>
  </div>

  <!-- Screensaver -->
  <div class="screensaver" id="screensaver" onclick="stopScreensaver();">
    <div class="screensaver-text">Kyle - Developer</div>
  </div>

  <script>
    // ========== AUDIO ==========
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx;
    let globalVolume = 0.8;

    // Authentic Windows XP Sounds
    const xpSounds = {
      click: 'https://www.winhistory.de/more/winstart/mp3/winxp.mp3',
      start: 'https://www.winhistory.de/more/winstart/mp3/winxpstart.mp3',
      startup: 'https://www.winhistory.de/more/winstart/mp3/winxp.mp3',
      error: 'https://www.myinstants.com/media/sounds/erro.mp3',
      notify: 'https://www.myinstants.com/media/sounds/windows-xp-balloon.mp3'
    };

    function playXPSound(soundUrl, volume = 0.5) {
      const audio = new Audio(soundUrl);
      audio.volume = volume * globalVolume;
      audio.play().catch(() => {});
    }

    function playClick() {
      playXPSound('https://www.myinstants.com/media/sounds/windows-xp-click.mp3', 0.3);
    }

    function playStartSound() {
      playXPSound('https://www.myinstants.com/media/sounds/windows-xp-balloon.mp3', 0.4);
    }

    function playWindowOpen() {
      playXPSound('https://www.myinstants.com/media/sounds/windows-xp-balloon.mp3', 0.3);
    }

    function playWindowClose() {
      playXPSound('https://www.myinstants.com/media/sounds/windows-xp-click.mp3', 0.3);
    }

    function playStartupSound() {
      playXPSound('https://www.winhistory.de/more/winstart/mp3/winxp.mp3', 0.5);
    }

    function playErrorSound() {
      playXPSound('https://www.myinstants.com/media/sounds/erro.mp3', 0.4);
    }

    function updateVolume(val) {
      globalVolume = val / 100;
      document.getElementById('volume-value').textContent = val;
      playClick();
    }

    // ========== WINDOW MANAGEMENT ==========
    let activeWindow = null;
    let dragOffset = { x: 0, y: 0 };
    let isDragging = false;
    let openWindows = new Set();
    let zCounter = 100;

    function openWindow(id) {
      const win = document.getElementById('window-' + id);
      if (win) {
        win.classList.remove('closing', 'minimizing');
        win.classList.add('active');
        bringToFront(win);
        openWindows.add(id);
        updateTaskbar();
        playWindowOpen();

        // Bounce the icon
        const icon = document.querySelector(`[data-window="${id}"]`);
        if (icon) {
          icon.classList.add('bounce');
          setTimeout(() => icon.classList.remove('bounce'), 300);
        }
      }
    }

    function closeWindow(id) {
      const win = document.getElementById('window-' + id);
      if (win) {
        playWindowClose();
        win.classList.add('closing');
        setTimeout(() => {
          win.classList.remove('active', 'closing');
          openWindows.delete(id);
          updateTaskbar();
        }, 150);
      }
    }

    function minimizeWindow(id) {
      const win = document.getElementById('window-' + id);
      if (win) {
        playClick();
        win.classList.add('minimizing');
        setTimeout(() => {
          win.classList.remove('active', 'minimizing');
        }, 300);
      }
    }

    function maximizeWindow(id) {
      const win = document.getElementById('window-' + id);
      if (win) {
        playClick();
        if (win.style.width === '100%') {
          win.style.width = '600px';
          win.style.height = '';
          win.style.top = '60px';
          win.style.left = '180px';
        } else {
          win.style.width = '100%';
          win.style.height = 'calc(100% - 30px)';
          win.style.top = '0';
          win.style.left = '0';
        }
      }
    }

    function bringToFront(win) {
      zCounter++;
      win.style.zIndex = zCounter;
    }

    function startDrag(e, winId) {
      const win = document.getElementById(winId);
      isDragging = true;
      activeWindow = win;
      bringToFront(win);
      dragOffset.x = e.clientX - win.offsetLeft;
      dragOffset.y = e.clientY - win.offsetTop;
      document.addEventListener('mousemove', drag);
      document.addEventListener('mouseup', stopDrag);
      e.preventDefault();
    }

    function drag(e) {
      if (isDragging && activeWindow) {
        let newX = e.clientX - dragOffset.x;
        let newY = e.clientY - dragOffset.y;
        newX = Math.max(0, Math.min(newX, window.innerWidth - 100));
        newY = Math.max(0, Math.min(newY, window.innerHeight - 60));
        activeWindow.style.left = newX + 'px';
        activeWindow.style.top = newY + 'px';
      }
    }

    function stopDrag() {
      isDragging = false;
      activeWindow = null;
      document.removeEventListener('mousemove', drag);
      document.removeEventListener('mouseup', stopDrag);
    }

    // ========== ICON SELECTION ==========
    function selectIcon(icon) {
      document.querySelectorAll('.desktop-icon').forEach(i => i.classList.remove('selected'));
      icon.classList.add('selected');
    }

    // ========== TASKBAR ==========
    function updateTaskbar() {
      const taskbarApps = document.getElementById('taskbar-apps');
      taskbarApps.innerHTML = '';
      openWindows.forEach(id => {
        const win = document.getElementById('window-' + id);
        if (win) {
          const title = win.querySelector('.window-title').textContent;
          const icon = win.querySelector('.window-titlebar img').src;
          const app = document.createElement('div');
          app.className = 'taskbar-app';
          app.innerHTML = `<img src="${icon}"><span>${title}</span>`;
          app.onclick = () => {
            if (!win.classList.contains('active')) {
              win.classList.remove('minimizing');
              win.classList.add('active');
            }
            bringToFront(win);
            playClick();
          };
          taskbarApps.appendChild(app);
        }
      });
    }

    // ========== START MENU ==========
    function toggleStartMenu() {
      const menu = document.getElementById('start-menu');
      const btn = document.getElementById('start-btn');
      menu.classList.toggle('active');
      btn.classList.toggle('pressed');

      // Close other popups
      document.getElementById('calendar-popup').classList.remove('active');
      document.getElementById('wifi-popup').classList.remove('active');
      document.getElementById('volume-popup').classList.remove('active');
    }

    // ========== SYSTEM TRAY ==========
    function toggleCalendar() {
      const popup = document.getElementById('calendar-popup');
      popup.classList.toggle('active');
      document.getElementById('wifi-popup').classList.remove('active');
      document.getElementById('volume-popup').classList.remove('active');
      document.getElementById('start-menu').classList.remove('active');

      if (popup.classList.contains('active')) {
        renderCalendar();
      }
    }

    function toggleWifi() {
      const popup = document.getElementById('wifi-popup');
      popup.classList.toggle('active');
      document.getElementById('calendar-popup').classList.remove('active');
      document.getElementById('volume-popup').classList.remove('active');
      document.getElementById('start-menu').classList.remove('active');
    }

    function toggleVolume() {
      const popup = document.getElementById('volume-popup');
      popup.classList.toggle('active');
      document.getElementById('calendar-popup').classList.remove('active');
      document.getElementById('wifi-popup').classList.remove('active');
      document.getElementById('start-menu').classList.remove('active');
    }

    function renderCalendar() {
      const now = new Date();
      const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'];

      document.getElementById('calendar-month').textContent =
        `${monthNames[now.getMonth()]} ${now.getFullYear()}`;

      const grid = document.getElementById('calendar-grid');
      grid.innerHTML = '';

      const days = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];
      days.forEach(day => {
        const el = document.createElement('div');
        el.className = 'calendar-day header';
        el.textContent = day;
        grid.appendChild(el);
      });

      const firstDay = new Date(now.getFullYear(), now.getMonth(), 1).getDay();
      const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();

      for (let i = 0; i < firstDay; i++) {
        const el = document.createElement('div');
        el.className = 'calendar-day empty';
        grid.appendChild(el);
      }

      for (let i = 1; i <= daysInMonth; i++) {
        const el = document.createElement('div');
        el.className = 'calendar-day';
        if (i === now.getDate()) el.classList.add('today');
        el.textContent = i;
        grid.appendChild(el);
      }
    }

    // ========== CLOCK ==========
    function updateClock() {
      const now = new Date();
      document.getElementById('clock').textContent = now.toLocaleTimeString('en-US', {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }
    updateClock();
    setInterval(updateClock, 1000);

    // ========== NOTIFICATIONS ==========
    function showNotification(title, body) {
      const notif = document.getElementById('notification');
      document.getElementById('notif-title').textContent = title;
      document.getElementById('notif-body').textContent = body;
      notif.classList.add('active');
      setTimeout(() => notif.classList.remove('active'), 4000);
    }

    // ========== SHUTDOWN ==========
    function showShutdown() {
      document.getElementById('shutdown-dialog').classList.add('active');
      document.getElementById('start-menu').classList.remove('active');
    }

    function hideShutdown() {
      document.getElementById('shutdown-dialog').classList.remove('active');
    }

    function triggerShutdown() {
      playClick();
      document.body.style.transition = 'opacity 2s';
      document.body.style.opacity = '0';
      setTimeout(() => {
        document.body.innerHTML = '<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#000;color:#fff;font-family:Tahoma;">It is now safe to turn off your computer.</div>';
        document.body.style.opacity = '1';
      }, 2000);
    }

    // ========== SCREENSAVER ==========
    let screensaverActive = false;

    function startScreensaver() {
      screensaverActive = true;
      document.getElementById('screensaver').classList.add('active');
    }

    function stopScreensaver() {
      if (screensaverActive) {
        screensaverActive = false;
        document.getElementById('screensaver').classList.remove('active');
        playClick();
      }
    }

    // ========== CLICK OUTSIDE TO CLOSE ==========
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) {
        document.getElementById('start-menu').classList.remove('active');
        document.getElementById('start-btn').classList.remove('pressed');
      }
      if (!e.target.closest('.calendar-popup') && !e.target.closest('.system-time')) {
        document.getElementById('calendar-popup').classList.remove('active');
      }
      if (!e.target.closest('.wifi-popup') && !e.target.closest('.tray-btn')) {
        document.getElementById('wifi-popup').classList.remove('active');
      }
      if (!e.target.closest('.volume-popup') && !e.target.closest('.tray-btn')) {
        document.getElementById('volume-popup').classList.remove('active');
      }
    });

    // ========== THREE.JS BACKGROUND ==========
    function initThreeJS() {
      const canvas = document.getElementById('three-bg');
      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0x000000, 0);

      // Create floating particles
      const particles = [];
      const particleGeometry = new THREE.SphereGeometry(0.05, 8, 8);
      const particleMaterial = new THREE.MeshBasicMaterial({
        color: 0xffffff,
        transparent: true,
        opacity: 0.3
      });

      for (let i = 0; i < 100; i++) {
        const particle = new THREE.Mesh(particleGeometry, particleMaterial.clone());
        particle.position.x = (Math.random() - 0.5) * 20;
        particle.position.y = (Math.random() - 0.5) * 20;
        particle.position.z = (Math.random() - 0.5) * 10 - 5;
        particle.userData.velocity = {
          x: (Math.random() - 0.5) * 0.01,
          y: (Math.random() - 0.5) * 0.01,
          z: (Math.random() - 0.5) * 0.005
        };
        particles.push(particle);
        scene.add(particle);
      }

      camera.position.z = 5;

      function animate() {
        requestAnimationFrame(animate);

        particles.forEach(p => {
          p.position.x += p.userData.velocity.x;
          p.position.y += p.userData.velocity.y;
          p.position.z += p.userData.velocity.z;

          if (Math.abs(p.position.x) > 10) p.userData.velocity.x *= -1;
          if (Math.abs(p.position.y) > 10) p.userData.velocity.y *= -1;
          if (p.position.z > 0 || p.position.z < -10) p.userData.velocity.z *= -1;

          p.material.opacity = 0.1 + Math.sin(Date.now() * 0.001 + p.position.x) * 0.1;
        });

        renderer.render(scene, camera);
      }
      animate();

      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    }

    // ========== BOOT SEQUENCE ==========
    function bootSequence() {
      const bootScreen = document.getElementById('boot-screen');
      const desktop = document.getElementById('desktop');

      setTimeout(() => {
        bootScreen.classList.add('hidden');
        desktop.style.display = 'block';
        initThreeJS();
        playStartupSound();

        // Show welcome notification
        setTimeout(() => {
          showNotification('Welcome!', 'Click Start to explore my portfolio. Try the WiFi icon for a surprise!');
        }, 1500);

        // Auto-start music after boot
        setTimeout(() => {
          if (musicInitialized && ytPlayer && !isMusicPlaying) {
            ytPlayer.playVideo();
            document.getElementById('music-btn').classList.add('playing');
            isMusicPlaying = true;
          }
        }, 2000);
      }, 2500);
    }

    // Start boot sequence
    window.onload = bootSequence;

    // YouTube Music Player
    let ytPlayer = null;
    let isMusicPlaying = false;
    let musicInitialized = false;

    function onYouTubeIframeAPIReady() {
      ytPlayer = new YT.Player('yt-player', {
        height: '0',
        width: '0',
        videoId: 'RSFqIWudfq0',
        playerVars: {
          autoplay: 0,
          loop: 1,
          playlist: 'RSFqIWudfq0',
          controls: 0,
          disablekb: 1,
          modestbranding: 1
        },
        events: {
          onReady: onPlayerReady,
          onStateChange: onPlayerStateChange
        }
      });
    }

    function onPlayerReady(event) {
      ytPlayer.setVolume(30);
      musicInitialized = true;
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.ENDED) {
        ytPlayer.playVideo();
      }
    }

    function toggleMusic() {
      if (!musicInitialized || !ytPlayer) {
        showNotification('Music', 'Music player is loading...');
        return;
      }

      const musicBtn = document.getElementById('music-btn');

      if (isMusicPlaying) {
        ytPlayer.pauseVideo();
        musicBtn.classList.remove('playing');
        isMusicPlaying = false;
        showNotification('Music', 'Music paused');
      } else {
        ytPlayer.playVideo();
        musicBtn.classList.add('playing');
        isMusicPlaying = true;
        showNotification('Music', 'Now playing: Lofi beats üéµ');
      }
    }
  </script>

  <!-- Hidden YouTube Player -->
  <div id="yt-player" style="position: absolute; left: -9999px; top: -9999px;"></div>
</body>
</html>
